// ===============================
// Patient Information
// ===============================
var Cedula = msg['IDPrincipalActual'];
var DateBirth = msg['FechaNacimiento'];
var eMail = msg['CorreoElectronico'];
//var Employer = msg['Employer'];
var IdFamiliar = msg['IdFamiliar'];
var IdMedicalCore = msg['IdPaciente'];
var IdPrincipalNuevo = msg['IdPrincipalNuevo'];
//var NumberRFC = msg['NumberRFC'];
//var Patient1stLastName = msg['Patient1stLastName'];
var PatientLastName = msg['Apellidos'];
var PatientName = msg['Nombres'];
//var Relation = msg['Relation'];
var Sex = msg['Sexo'];
var TelMovil = msg['Telefono'];

var PostalAddress1 =msg['Direccion']['Postal']['Calle']

var AccountNumber = msg['NumeroRequisicionPedido'];
var AssignedPatientLocation = msg['UbicacionPaciente']
var Destination = msg['IDDestino'];
var Destino = msg['Destino'];

var Diagnosis = msg['IDDiagnostico'];
//var Employeer = msg['RequisitionDetails']['Employeer'];
var IdService = msg['IDServicio'];

var LocationID = msg['IDCentroExtraccion'];
var PatientClass = msg['IDTipoPaciente'];
//var PatientNumber = msg['RequisitionDetails']['PatientNumber'];

var RefDoctorNumber = msg['IDDoctor'];
var RefDoctorName = msg['Doctor'];

var RequisitionDate = msg['FechaAtencion'];
//var RequisitionTime = msg['RequisitionDetails']['RequisitionTime'];
//var Service = msg['RequisitionDetails']['Service'];
//var ServicePlace = msg['RequisitionDetails']['ServicePlace'];
//var ServiceReason = msg['RequisitionDetails']['ServiceReason'];
//var ServiceType = msg['RequisitionDetails']['ServiceType'];

// ===============================
// ICD Codes
// ===============================
//var ICDCode01 = msg['RequisitionDetails']['ICDCodes']['ICDCode01'];

// ===============================
// Procedure Details (Arrays)
// ===============================

var LineNumber = [];
var ProcNumber = [];
var ProcName = [];
var QtyProcedures = [];
var InvoiceCodeINT = [];
var Amount = [];
var AmountIns = [];
var AmountPat = [];
var AdditionalCharge = [];
//var Priority = [];

for (var i = 0; i < getArrayOrXmlLength(msg['Procedures']); i++) {
    LineNumber.push(msg['Procedures'][i]['NumeroLinea']);
    ProcNumber.push(msg['Procedures'][i]['IDProcedimiento']);
    ProcName.push(msg['Procedures'][i]['Procedimiento']);
    
    //QtyProcedures.push(msg['RequisitionDetails']['Procedures'][i]['QtyProcedures']);
    //InvoiceCodeINT.push(msg['RequisitionDetails']['Procedures'][i]['InvoiceCodeINT']);
    //Amount.push(msg['RequisitionDetails']['Procedures'][i]['Amount']);
    //AmountIns.push(msg['RequisitionDetails']['Procedures'][i]['AmountIns']);
    //AmountPat.push(msg['RequisitionDetails']['Procedures'][i]['AmountPat']);
    //AdditionalCharge.push(msg['RequisitionDetails']['Procedures'][i]['AdditionalCharge']);
    
    //Priority.push(msg['RequisitionDetails']['Procedures'][i]['Priority']);

    logger.info("Index: " + i + " | ProcNum: " + msg['Procedures'][i]['NumeroLinea']);
}

var prioridad = msg['Prioridad'];


// ===============================
// Store Values in channelMap
// ===============================

// Patient
channelMap.put("Cedula", Cedula);
channelMap.put("DateBirth", DateBirth);
channelMap.put("eMail", eMail);
//channelMap.put("Employer", Employer);
channelMap.put("IdFamiliar", IdFamiliar);
channelMap.put("IdMedicalCore", IdMedicalCore);
channelMap.put("IdPrincipalNuevo", IdPrincipalNuevo);
//channelMap.put("NumberRFC", NumberRFC);
channelMap.put("Patient1stLastName", Patient1stLastName);
channelMap.put("Patient2ndLastName", Patient2ndLastName);
channelMap.put("PatientName", PatientName);
channelMap.put("Relation", Relation);
channelMap.put("Sex", Sex);
channelMap.put("TelMovil", TelMovil);

channelMap.put("PostalAddress1", PostalAddress1);

// Requisition
channelMap.put("AccountNumber", AccountNumber);
channelMap.put("AssignedPatientLocation", AssignedPatientLocation);
channelMap.put("Destination", Destination);
channelMap.put("Diagnosis", Diagnosis);
//channelMap.put("Employeer", Employeer);
channelMap.put("IdService", IdService);
channelMap.put("LocationID", LocationID);
channelMap.put("PatientClass", PatientClass);
channelMap.put("PatientNumber", PatientNumber);
channelMap.put("RefDoctorName", RefDoctorName);
channelMap.put("RefDoctorNumber", RefDoctorNumber);
channelMap.put("RequisitionDate", RequisitionDate);
channelMap.put("RequisitionTime", RequisitionTime);
channelMap.put("Service", Service);


// Procedures
channelMap.put("LineNumber", LineNumber);
channelMap.put("ProcNumber", ProcNumber);
channelMap.put("ProcName", ProcName);
//

channelMap.put("Priority", prioridad);
